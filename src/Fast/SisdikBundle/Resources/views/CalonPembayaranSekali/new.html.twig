{% extends 'FastSisdikBundle::layout.html.twig' %}

{% block page_heading %}{% trans from "headings" %}applicant.payment.oncefee{% endtrans %}{% endblock %}
{% block content %}
<style type="text/css">
.content .ui-multiselect {
    line-height: 1em;
}
.ui-multiselect .actions {
    padding: 0;
    margin-top: 0;
    border-radius: 0;
}
.ui-helper-clearfix {
    margin-bottom: 18px;
}
</style>

{% stylesheets '@FastSisdikBundle/Resources/public/css/ui.multiselect.css' %}
<link rel="stylesheet" href="{{ asset_url }}" />
{% endstylesheets %}

{% javascripts '@FastSisdikBundle/Resources/public/js/libraries/multiselect/ui.multiselect.js' %}
<script type="text/javascript" src="{{ asset_url }}"></script>
{% endjavascripts %}

<div class="row-fluid">
    <div class="span12">
        <dl>
            <dt>{{ 'label.yearentry.entry'|trans }}</dt>
            <dd>{% if calonSiswa.tahunmasuk is not null %}{{ calonSiswa.tahunmasuk.tahun }}{% endif %}</dd>
            <dt>{{ 'label.admissiongroup.entry'|trans }}</dt>
            <dd>{% if calonSiswa.gelombang is not null %}{{ calonSiswa.gelombang.nama }}{% endif %}</dd>
            <dt>{{ 'label.name.full'|trans }}</dt>
            <dd>{{ calonSiswa.namaLengkap }}</dd>
            <dt>{{ 'label.application.number'|trans }}</dt>
            <dd>{{ calonSiswa.nomorPendaftaran }}</dd>
            <dt>{{ 'label.gender'|trans }}</dt>
            <dd>{% if calonSiswa.jenisKelamin == 'L' %}{{ 'male'|trans }}{% elseif calonSiswa.jenisKelamin %}{{ 'female'|trans }}{% endif %}</dd>
            <dt>{{ 'label.name.parent.or.guardian'|trans }}</dt>
            <dd>
        		{% if calonSiswa.calonOrangtuaWali %}
        		    {% for orangtua in calonSiswa.calonOrangtuaWali %}
        		        {% if orangtua %}
        		            {% if orangtua.aktif == 1 %}
            		            {{ orangtua.nama }}<br />
            		        {% endif %}
        		        {% endif %}
        		    {% endfor %}
        		{% endif %}
        	</dd>
            <dt>{{ 'label.mobilephone.parent'|trans }}</dt>
            <dd>{{ calonSiswa.ponselOrangtuawali }}</dd>
        </dl>

<div class="clearfix" style="margin-bottom: 2em;"></div>

    <h4>{{ 'applicant.fee.once'|trans({}, 'headings') }}</h4>
    <form action="{{ path('applicant_payment_oncefee_create', { 'cid': calonSiswa.id, 'page': app.request.get('page') }) }}" method="post" {{ form_enctype(form) }} class="form-horizontal">
        {{ form_widget(form.daftarBiayaSekali, { 'attr': {'style': 'width: 750px; height: 230px;'} }) }}
        <div id="payment-info" style="margin-bottom: 18px;">
            {{ 'shortinfo.total.payables'|trans }} <b>{{ currencySymbol }}. <span id="fee-amount"></span></b>
        </div>
        {{ form_widget(form.calonTransaksiPembayaranSekali) }}
        {{ form_rest(form) }}
    	<div class="form-actions">
    	    <button type="submit" class="btn primary">{{ 'label.save'|trans }}</button>
        </div>
    </form>
    </div>
</div>

<div class="clearfix"></div>

<ul class="pills">
    <li>
        <a href="{{ path('applicant_payment', {'page': app.request.get('page')}) }}">{{ 'link.backtolist'|trans }}</a>
    </li>
</ul>

<div class="clearfix"></div>
<script language="javascript" type="text/javascript">
var total = 0;
var amount;

$(document).ready(function() {
    $(".multiselect option:selected").text(function(n, currenttext) {
        var num = 0;

        str = currenttext.split('.').join('');
        num = str.match(/\d+/);
        total += parseInt(num);
    });
    amount = total.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.");
    $("#fee-amount").text(amount);

    $(".multiselect").multiselect();
    $(".multiselect").change(function() {
        total = 0;

        $(".multiselect option:selected").text(function(n, currenttext) {
            var num = 0;

            str = currenttext.split('.').join('');
            num = str.match(/\d+/);
            total += parseInt(num);
        });

        amount = total.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.");

        $("#fee-amount").text(amount);
    });
});
</script>

{% endblock content %}
