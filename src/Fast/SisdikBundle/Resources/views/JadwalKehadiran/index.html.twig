{% extends 'FastSisdikBundle::layout.html.twig' %}

{% block page_heading %}{% trans from "headings" %}jadwal.kehadiran.daftar{% endtrans %}{% endblock %}

{% block content %}
<style type="text/css">
.control-group {
    display: inline-block;
    margin-right: 0.4em;
}
#start-icon {
    margin-left: 0px;
}
</style>

<div class="filter-section">
    <form method="GET" action="{{ path('jadwal_kehadiran_list', {'perulangan': perulangan}) }}" class="form-search form-inline">
        {{ form_widget(searchform) }}
        <button type="submit" class="btn primary alternative icon search">{{ 'label.view'|trans }}</button>
        <button class="btn" type="reset" onclick="window.location.href='{{ path('jadwal_kehadiran') }}'">{{ 'label.reset'|trans }}</button>
    </form>
</div>

{% if displayresult %}

<h4>
{{ 'label.year.entry'|trans }} {{ searchdata.tahunAkademik.nama }},
{{ 'label.class.entry'|trans }} {{ searchdata.kelas.nama }},
{{ 'label.jadwal'|trans }} {{ daftarPerulangan[searchdata.perulangan] }}{% if searchdata.mingguanHariKe is defined %}, {{ 'label.day'|trans }} {{ daynames[searchdata.mingguanHariKe]|trans }}{% endif %}{% if searchdata.bulananHariKe is defined %}, {{ 'label.dayno'|trans }} {{ searchdata.bulananHariKe }}{% endif %}
</h4>

<div class="clearfix"></div>

<div class="add-link">
{% image '@FastSisdikBundle/Resources/public/images/forms/icon_plus.gif' %}
    <a href="{{ path('jadwal_kehadiran_new') }}" class="add-link-a">
        <img src="{{ asset_url }}" alt="{{ 'alt.add'|trans }}" border="0" width="21" height="21" style="vertical-align: middle;" />
        {{ 'label.jadwal.kehadiran.tambah'|trans }}
    </a>
{% endimage %}
</div>

<div class="clearfix"></div>

<table class="table zebra-striped bordered-table" id="no-more-tables">
    <thead>
        <tr>
            <th>{{ 'label.status.kehadiran'|trans }}</th>
            <th>{{ 'label.parameter'|trans }}</th>
            <th>{{ 'label.kirim.sms'|trans }}</th>
            <th>{{ 'label.terhubung'|trans }}</th>
            <th>{{ 'label.options'|trans }}</th>
        </tr>
    </thead>
    <tbody>
    {% for data in pagination %}
        <tr>
            <td data-title="{{ 'label.status.kehadiran'|trans }}">
                {% if data.permulaan == 1 %}<i id="start-icon" class="icon-play"></i>{% endif %}{{ data.daftarStatusKehadiran[data.statusKehadiran]|trans }}
            </td>
            <td data-title="{{ 'label.parameter'|trans }}">
                {% if data.paramstatusDariJam is empty %}
                    &mdash;
                {% else %}
                    {{ data.paramstatusDariJam(false) }}
                {% endif %}
                <span class="separator">-</span>
                {% if data.paramStatusHinggaJam is empty %}
                    &mdash;
                {% else %}
                    {{ data.paramStatusHinggaJam(false) }}
                {% endif %}
            </td>
            <td data-title="{{ 'label.kirim.sms'|trans }}">
                {% if data.kirimSms is empty %}
                    {% image '@FastSisdikBundle/Resources/public/images/cross.png' %}
                    <img src="{{ asset_url }}" border="0" height="20" style="vertical-align: middle;" />
                    {% endimage %}
                {% else %}
                    {% image '@FastSisdikBundle/Resources/public/images/check2.png' %}
                    <img src="{{ asset_url }}" border="0" height="20" style="vertical-align: middle;" />
                    {% endimage %}
                {% endif %}
                <span class="separator">|</span>
                {% if data.smsJam is empty %}
                    &mdash;
                {% else %}
                    {{ data.smsJam(false) }}
                {% endif %}
                <span class="separator">|</span>
                {% if data.kirimSms is empty %}
                    &mdash;
                {% else %}
                    {% if data.templatesms is not null %}
                        {{ data.templatesms.nama }}
                    {% endif %}
                {% endif %}
            </td>
            <td data-title="{{ 'label.terhubung'|trans }}">
                {% if data.otomatisTerhubungMesin is empty %}
                    {% image '@FastSisdikBundle/Resources/public/images/cross.png' %}
                    <img src="{{ asset_url }}" border="0" height="20" style="vertical-align: middle;" />
                    {% endimage %}
                {% else %}
                    {% image '@FastSisdikBundle/Resources/public/images/check2.png' %}
                    <img src="{{ asset_url }}" border="0" height="20" style="vertical-align: middle;" />
                    {% endimage %}
                {% endif %}
            </td>
            <td data-title="{{ 'label.actions'|trans }}" class="row-actions">
                <a href="{{ path('jadwal_kehadiran_show', {'id': data.id}) }}" title="{{ 'tip.detail'|trans }}" class="icon-arrow-right"></a>
                <a href="{{ path('jadwal_kehadiran_edit', {'id': data.id}) }}" title="{% trans %}tip.edit{% endtrans %}" class="icon-edit info-tooltip"></a>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{{ knp_pagination_render(pagination) }}

<div>{{ 'shortinfo.duplicate.schedule'|trans }}</div>
<div>
    <form method="post" action="{{ path('jadwal_kehadiran_duplicate') }}" class="form-search form-inline">
        {{ form_widget(duplicateform) }}
        <button type="submit" class="btn success alternative icon share">{{ 'label.duplicate'|trans }}</button>
    </form>
</div>

<div class="clearfix"></div>

{% endif %}
{% endblock content %}

{% block javascripts_custom %}
<script language="javascript" type="text/javascript">
$(document).ready(function() {
    var url = "{{ path('data_class_ajax_updateclass') }}";

    $.get(url, {tahunAkademik: $(".selectyear").val(){% if searchdata.kelas is defined %}, kelas: {{ searchdata.kelas.id }}{% endif %}}, function(data) {
        var options = '';
        for (var i = 0; i < data.length; i++) {
            options += '<option value="' + data[i].optionValue + '"'
                + (data[i].optionSelected == 'selected' ? 'selected="selected"' : '') + '>'
                + data[i].optionDisplay + '</option>';
        }
        $(".selectclass").html(options);
    });

    $(".selectyear").change(function() {
        $(".selectclass").empty();
        $(".selectclass").html('<option>{{ 'alt.loading'|trans }}</option>');

        $.get(url, {tahunAkademik: $(this).val()}, function(data) {
            var options = '';
            for (var i = 0; i < data.length; i++) {
                options += '<option value="' + data[i].optionValue + '"'
                + (data[i].optionSelected == 'selected' ? 'selected="selected"' : '') + '>'
                + data[i].optionDisplay + '</option>';
            }
            $(".selectclass").html(options);
        });
    });

    $.get(url, {tahunAkademik: $(".selectyearduplicate").val()}, function(data) {
        var options = '';
        for (var i = 0; i < data.length; i++) {
            options += '<option value="' + data[i].optionValue + '"'
                + (data[i].optionSelected == 'selected' ? 'selected="selected"' : '') + '>'
                + data[i].optionDisplay + '</option>';
        }
        $(".selectclassduplicate").html(options);
    });

    $(".selectyearduplicate").change(function() {
        $(".selectclassduplicate").empty();
        $(".selectclassduplicate").html('<option>{{ 'alt.loading'|trans }}</option>');

        $.get(url, {tahunAkademik: $(this).val()}, function(data) {
            var options = '';
            for (var i = 0; i < data.length; i++) {
                options += '<option value="' + data[i].optionValue + '"'
                + (data[i].optionSelected == 'selected' ? 'selected="selected"' : '') + '>'
                + data[i].optionDisplay + '</option>';
            }
            $(".selectclassduplicate").html(options);
        });
    });
});
</script>
{% endblock %}
